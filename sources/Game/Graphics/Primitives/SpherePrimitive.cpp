#include "SpherePrimitive.h"

const float SPHERE_VERTICES_RAW_DATA[] = {
	0.000000000000f, 1.000000000000f, -0.000000000000f,
	0.360729157925f, 0.932670652866f, -0.000000000000f,
	0.111471429467f, 0.932670652866f, -0.343073815107f,
	0.672882914543f, 0.739748895168f, -0.000000000000f,
	0.479505807161f, 0.805421888828f, -0.348381429911f,
	0.207932248712f, 0.739748895168f, -0.639949798584f,
	0.894427180290f, 0.447213590145f, -0.000000000000f,
	0.784354329109f, 0.516806006432f, -0.343073815107f,
	0.568661391735f, 0.516806006432f, -0.639949798584f,
	0.276393175125f, 0.447213590145f, -0.850650846958f,
	-0.291836053133f, 0.932670652866f, -0.212031245232f,
	-0.183154940605f, 0.805421888828f, -0.563692927361f,
	-0.544373750687f, 0.739748895168f, -0.395510613918f,
	-0.083903789520f, 0.516806006432f, -0.851981043816f,
	-0.432902306318f, 0.516806006432f, -0.738584458828f,
	-0.723606824875f, 0.447213590145f, -0.525731027126f,
	-0.291835993528f, 0.932670652866f, 0.212031304836f,
	-0.592701852322f, 0.805421888828f, 0.000000082041f,
	-0.544373750687f, 0.739748895168f, 0.395510762930f,
	-0.836209833622f, 0.516806006432f, -0.183479294181f,
	-0.836209833622f, 0.516806006432f, 0.183479532599f,
	-0.723606765270f, 0.447213590145f, 0.525731205940f,
	0.111471489072f, 0.932670652866f, 0.343073815107f,
	-0.183154881001f, 0.805421888828f, 0.563692986965f,
	0.207932367921f, 0.739748895168f, 0.639949679375f,
	-0.432902246714f, 0.516806006432f, 0.738584578037f,
	-0.083903640509f, 0.516806006432f, 0.851981043816f,
	0.276393324137f, 0.447213590145f, 0.850650787354f,
	0.479505896568f, 0.805421888828f, 0.348381400108f,
	0.568661451340f, 0.516806006432f, 0.639949679375f,
	0.784354448318f, 0.516806006432f, 0.343073785305f,
	0.964719116688f, 0.156076937914f, 0.212031155825f,
	0.964718937874f, 0.156076908112f, -0.212031245232f,
	0.905103087425f, -0.156076937914f, 0.395510494709f,
	0.985455691814f, -0.169933021069f, -0.000000082041f,
	0.905102908611f, -0.156076908112f, -0.395510643721f,
	0.723607003689f, -0.447213590145f, 0.525730848312f,
	0.836209833622f, -0.516806006432f, 0.183479219675f,
	0.836209833622f, -0.516806006432f, -0.183479517698f,
	0.723606824875f, -0.447213590145f, -0.525731086731f,
	0.499768316746f, 0.156076893210f, -0.851981043816f,
	0.096460796893f, 0.156076908112f, -0.983023464680f,
	0.655845224857f, -0.156076893210f, -0.738584458828f,
	0.304522544146f, -0.169933006167f, -0.937223970890f,
	-0.096460871398f, -0.156076908112f, -0.983023524284f,
	0.432902306318f, -0.516806006432f, -0.738584458828f,
	0.083903737366f, -0.516806006432f, -0.851980984211f,
	-0.276393234730f, -0.447213590145f, -0.850650787354f,
	-0.655845224857f, 0.156076893210f, -0.738584458828f,
	-0.905102908611f, 0.156076908112f, -0.395510554314f,
	-0.499768346548f, -0.156076893210f, -0.851980984211f,
	-0.797250270844f, -0.169932991266f, -0.579236209393f,
	-0.964718937874f, -0.156076908112f, -0.212031170726f,
	-0.568661510944f, -0.516806006432f, -0.639949679375f,
	-0.784354388714f, -0.516806006432f, -0.343073755503f,
	-0.894427180290f, -0.447213590145f, 0.000000078193f,
	-0.905102789402f, 0.156076908112f, 0.395510762930f,
	-0.655845165253f, 0.156076908112f, 0.738584518433f,
	-0.964718937874f, -0.156076908112f, 0.212031364441f,
	-0.797250330448f, -0.169933021069f, 0.579236328602f,
	-0.499768286943f, -0.156076908112f, 0.851980984211f,
	-0.784354448318f, -0.516806066036f, 0.343073844910f,
	-0.568661451340f, -0.516806066036f, 0.639949798584f,
	-0.276393294334f, -0.447213590145f, 0.850650787354f,
	0.096460893750f, 0.156076893210f, 0.983023464680f,
	0.499768465757f, 0.156076893210f, 0.851980924606f,
	-0.096460856497f, -0.156076893210f, 0.983023464680f,
	0.304522633553f, -0.169933006167f, 0.937223911285f,
	0.655845403671f, -0.156076893210f, 0.738584339619f,
	0.083903796971f, -0.516806185246f, 0.851981103420f,
	0.432902514935f, -0.516806185246f, 0.738584458828f,
	0.797250390053f, 0.169933006167f, -0.579236268997f,
	-0.304522573948f, 0.169933006167f, -0.937223970890f,
	-0.985455572605f, 0.169933021069f, 0.000000102551f,
	-0.304522484541f, 0.169933006167f, 0.937223970890f,
	0.797250568867f, 0.169933021069f, 0.579236149788f,
	0.000000000000f, -1.000000000000f, -0.000000000000f,
	-0.111471459270f, -0.932670652866f, -0.343073815107f,
	0.291836053133f, -0.932670652866f, -0.212031260133f,
	-0.207932293415f, -0.739748895168f, -0.639949679375f,
	0.183154925704f, -0.805421888828f, -0.563692927361f,
	0.544373750687f, -0.739748895168f, -0.395510673523f,
	-0.360729157925f, -0.932670652866f, 0.000000031536f,
	-0.672882914543f, -0.739748895168f, 0.000000058825f,
	-0.479505836964f, -0.805421888828f, -0.348381340504f,
	-0.111471474171f, -0.932670652866f, 0.343073815107f,
	-0.207932353020f, -0.739748895168f, 0.639949679375f,
	-0.479505896568f, -0.805421888828f, 0.348381459713f,
	0.291836112738f, -0.932670652866f, 0.212031170726f,
	0.544373929501f, -0.739748895168f, 0.395510464907f,
	0.183155000210f, -0.805421948433f, 0.563692808151f,
	0.592701852322f, -0.805421769619f, -0.000000123062f
};

const unsigned int SPHERE_INDICES_RAW_DATA[] = {
	0, 1, 2, 1, 3, 4, 1, 4, 2, 2, 4, 5, 3, 6, 7, 3, 7, 4, 4, 7, 8, 4, 8, 5, 5, 8,
	9, 0, 2, 10, 2, 5, 11, 2, 11, 10, 10, 11, 12, 5, 9, 13, 5, 13, 11, 11, 13, 14,
	11, 14, 12, 12, 14, 15, 0, 10, 16, 10, 12, 17, 10, 17, 16, 16, 17, 18, 12, 15,
	19, 12, 19, 17, 17, 19, 20, 17, 20, 18, 18, 20, 21, 0, 16, 22, 16, 18, 23, 16,
	23, 22, 22, 23, 24, 18, 21, 25, 18, 25, 23, 23, 25, 26, 23, 26, 24, 24, 26, 27,
	0, 22, 1, 22, 24, 28, 22, 28, 1, 1, 28, 3, 24, 27, 29, 24, 29, 28, 28, 29, 30,
	28, 30, 3, 3, 30, 6, 6, 31, 32, 31, 33, 34, 31, 34, 32, 32, 34, 35, 33, 36, 37,
	33, 37, 34, 34, 37, 38, 34, 38, 35, 35, 38, 39, 9, 40, 41, 40, 42, 43, 40, 43,
	41, 41, 43, 44, 42, 39, 45, 42, 45, 43, 43, 45, 46, 43, 46, 44, 44, 46, 47, 15,
	48, 49, 48, 50, 51, 48, 51, 49, 49, 51, 52, 50, 47, 53, 50, 53, 51, 51, 53, 54,
	51, 54, 52, 52, 54, 55, 21, 56, 57, 56, 58, 59, 56, 59, 57, 57, 59, 60, 58, 55,
	61, 58, 61, 59, 59, 61, 62, 59, 62, 60, 60, 62, 63, 27, 64, 65, 64, 66, 67, 64,
	67, 65, 65, 67, 68, 66, 63, 69, 66, 69, 67, 67, 69, 70, 67, 70, 68, 68, 70, 36,
	39, 42, 35, 42, 40, 71, 42, 71, 35, 35, 71, 32, 40, 9, 8, 40, 8, 71, 71, 8, 7,
	71, 7, 32, 32, 7, 6, 47, 50, 44, 50, 48, 72, 50, 72, 44, 44, 72, 41, 48, 15, 14,
	48, 14, 72, 72, 14, 13, 72, 13, 41, 41, 13, 9, 55, 58, 52, 58, 56, 73, 58, 73, 52,
	52, 73, 49, 56, 21, 20, 56, 20, 73, 73, 20, 19, 73, 19, 49, 49, 19, 15, 63, 66, 60,
	66, 64, 74, 66, 74, 60, 60, 74, 57, 64, 27, 26, 64, 26, 74, 74, 26, 25, 74, 25, 57,
	57, 25, 21, 36, 33, 68, 33, 31, 75, 33, 75, 68, 68, 75, 65, 31, 6, 30, 31, 30, 75,
	75, 30, 29, 75, 29, 65, 65, 29, 27, 76, 77, 78, 77, 79, 80, 77, 80, 78, 78, 80, 81,
	79, 47, 46, 79, 46, 80, 80, 46, 45, 80, 45, 81, 81, 45, 39, 76, 82, 77, 82, 83, 84,
	82, 84, 77, 77, 84, 79, 83, 55, 54, 83, 54, 84, 84, 54, 53, 84, 53, 79, 79, 53, 47,
	76, 85, 82, 85, 86, 87, 85, 87, 82, 82, 87, 83, 86, 63, 62, 86, 62, 87, 87, 62, 61,
	87, 61, 83, 83, 61, 55, 76, 88, 85, 88, 89, 90, 88, 90, 85, 85, 90, 86, 89, 36, 70,
	89, 70, 90, 90, 70, 69, 90, 69, 86, 86, 69, 63, 76, 78, 88, 78, 81, 91, 78, 91, 88,
	88, 91, 89, 81, 39, 38, 81, 38, 91, 91, 38, 37, 91, 37, 89, 89, 37, 36
};

SpherePrimitive::SpherePrimitive(GraphicsResourceFactory* graphicsResourceFactory)
	: m_geometry(graphicsResourceFactory->createGeometryStore())
{
	GeometryStore::BufferId vertexBufferId = m_geometry->requireBuffer(GeometryStore::BufferType::Vertex,
		GeometryStore::BufferUsage::StaticDraw, sizeof(SPHERE_VERTICES_RAW_DATA));
	m_geometry->setBufferData(vertexBufferId, 0, sizeof(SPHERE_VERTICES_RAW_DATA), (const std::byte*)SPHERE_VERTICES_RAW_DATA);

	GeometryStore::BufferId indexBufferId = m_geometry->requireBuffer(GeometryStore::BufferType::Index, 
		GeometryStore::BufferUsage::StaticDraw, sizeof(SPHERE_INDICES_RAW_DATA));
	m_geometry->setBufferData(indexBufferId, 0, sizeof(SPHERE_INDICES_RAW_DATA), (const std::byte*)SPHERE_INDICES_RAW_DATA);

	// Set vertex layout description
	m_geometry->setVertexLayoutAttribute(0, vertexBufferId, 3,
		GeometryStore::VertexLayoutAttributeBaseType::Float, false, 0, 0);

	m_geometry->create();
}

SpherePrimitive::~SpherePrimitive()
{
	delete m_geometry;
}

void SpherePrimitive::render()
{
	m_geometry->bind();
	m_geometry->drawElements(GeometryStore::DrawType::Triangles, 0, 
		sizeof(SPHERE_INDICES_RAW_DATA) / sizeof(SPHERE_INDICES_RAW_DATA[0]),
		GeometryStore::IndicesType::UnsignedInt);
	m_geometry->unbind();
}